@startuml
!theme plain
hide circle
top to bottom direction
!pragma useVerticalIf on
skinparam dpi 350
skinparam packageStyle rectangle
skinparam rectangle {
  BackgroundColor #f7f4eb
  BorderColor Black
}

' === DDD DEFINITIONS ===
!define ENTITY(e) class e <<Entity>>
!define AGGREGATE(a) class a <<Aggregate>>
!define AGGREGATE_ROOT(ar) class ar <<Aggregate Root>>
!define VALUE_OBJECT(vo) class vo <<Value Object>>
!define ENUM(enum) class enum <<Enum>>

title Visual Impact Platform - Domain Driven Design Context Map

' ===============================
' AUTHENTICATION & IDENTITY
' ===============================
package "Authentication & Identity Subdomain" #LightSteelBlue {
  AGGREGATE_ROOT(UserAccount) #LightBlue {
    auth0UserId: String
    name: String
    contactNumber: String
    email: String
  }

  VALUE_OBJECT(UserCredentials) #Bisque {
    username: String
    passwordHash: String
  }

  VALUE_OBJECT(UserIdentifier) #Bisque {
    userId: UUID
  }

  ENUM(role) #Orange {
    ADVERTISER
    MEDIA_OWNER
    ADMIN
  }

  ENUM(languagePreference) #Orange {
    ENGLISH
    FRENCH
  }

  UserAccount "1" o--> "1" UserCredentials
  UserAccount "1" o--> "1" UserIdentifier
  UserAccount "1" o--> "1" role
  UserAccount "1" o--> "1" languagePreference
}

' ===============================
' ADVERTISER MANAGEMENT
' ===============================
package "Advertiser Management Subdomain" #LightYellow {
  AGGREGATE_ROOT(AdvertiserCompany) #LightBlue {
    companyName: String
    allowedScreenTimePercentage: Decimal
  }

  ENTITY(AdPlan) #LightBlue {
    planId: UUID
    maxScreensAllowed: Int
    monthlyBudget: Decimal
  }

  VALUE_OBJECT(CompanyVerification) #Bisque {
    verified: Boolean
    verifiedDate: Date
  }

  ENUM (CompanyType) #Orange {
      SMALL
      MEDIUM
      LARGE
   }

  AdvertiserCompany "1" o--> "1..*" AdPlan
  AdvertiserCompany "1" o--> "1" CompanyVerification
  AdvertiserCompany "1" o--> "1" CompanyType
}

' ===============================
' AD SPACE OWNER MANAGEMENT
' ===============================
package "Ad Space Owner Management Subdomain" #LightGreen {
  AGGREGATE_ROOT(AdSpaceOwner) #LightBlue {
    businessName: String
  }

  ENTITY(MediaAsset) #LightBlue {
    title: String
    estimatedWeeklyViews: Int
    pricePerWeek: Decimal
  }


  VALUE_OBJECT(MediaIdentifier) #Bisque {
    mediaId: UUID
  }

  VALUE_OBJECT(MediaLocation) #Bisque {
    latitude: Float
    longitude: Float
    address: String
  }

  VALUE_OBJECT(MediaSize) #Bisque {
    width: Float
    height: Float
    unit: Enum(foot^2)
  }

  VALUE_OBJECT(RevenueSummary) #Bisque {
    totalRevenue: Decimal
    lastPaymentDate: Date
  }

  ENUM (Status) #Orange {
      ACTIVE
      INACTIVE
      PENDING
      REJECTED
   }

   ENUM (Type) #Orange {
      DIGITAL_SCREEN
      PHYSICAL POSTER
   }

  AdSpaceOwner "1" o--> "1..*" MediaAsset
  AdSpaceOwner "1" o--> "1..*" RevenueSummary
  MediaAsset "1" o--> "1..*" MediaLocation
  MediaAsset "1" o--> "1" MediaSize
  MediaAsset "1" o--> "1" MediaIdentifier
  MediaAsset "1" o--> "1" Status
  MediaAsset "1" o--> "1" Type
}

' ===============================
' ADVERTISEMENT & BOOKING
' ===============================
package "Advertisement & Booking Subdomain" #LightCoral {
  AGGREGATE_ROOT(Advertisement) #LightBlue {
    startDate: Date
    endDate: Date
    budget: Decimal
  }

  ENTITY(AdPlacement) #LightBlue {
    placementId: UUID
    screenTimeMinutes: Int
    cost: Decimal
    approvedByOwner: Boolean
  }

  VALUE_OBJECT(AdIdentifier) #Bisque {
    adId: UUID
  }

  VALUE_OBJECT(ImpressionMetrics) #Bisque {
    estimatedWeeklyImpressions: Int
    actualImpressions: Int
  }

  VALUE_OBJECT(CostMetrics) #Bisque {
    CPM: Decimal
    totalSpend: Decimal
  }

  ENUM(Status) #Orange {
      ACTIVE
      INACTIVE
      PENDING
      REJECTED
   }

  Advertisement "1" o--> "1" AdIdentifier
  Advertisement "1" o--> "1..*" AdPlacement
  Advertisement "1" o--> "1" ImpressionMetrics
  Advertisement "1" o--> "1" CostMetrics
    Advertisement "1" o--> "1" Status
}

' ===============================
' TRANSACTIONS
' ===============================
package "Transactions Subdomain" #LightPink {
  AGGREGATE_ROOT(Transaction) #LightBlue {
    amount: Decimal
    currency: String
    timestamp: DateTime
  }

  ENTITY(Invoice) #LightBlue {
    invoiceId: UUID
    dueDate: Date
    paid: Boolean
  }

VALUE_OBJECT(TransactionIdentifier) #Bisque {
    transactionId: UUID
  }

  VALUE_OBJECT(PaymentMethod) #Bisque {
    methodType: Enum(CreditCard|PayPal|Stripe)
    last4Digits: String
  }



  VALUE_OBJECT(TransactionInfo) #Bisque {
    companyName: String
    taxNumber: String
    billingAddress: String
  }

  ENUM (Status) #Orange {
      SUCCESS
      FAILED
      PENDING
   }

  Transaction "1" o--> "1" Invoice
  Transaction "1" o--> "1" PaymentMethod
  Transaction "1" o--> "1" TransactionInfo
  Transaction "1" o--> "1" TransactionIdentifier
  Transaction "*" o--> "1" UserIdentifier
  Transaction "1" o--> "1" Status
}

' ===============================
' ADMIN & MODERATION
' ===============================
package "Admin & Moderation Subdomain" #LightCyan {
  AGGREGATE_ROOT(Admin) #LightBlue {
    permissions: Enum
  }

  ENTITY(VerificationRequest) #LightBlue {
    requestId: UUID
    companyId: UUID
    submittedDocs: URL
  }

  ENTITY(ContentModeration) #LightBlue {
    moderationId: UUID
    mediaId: UUID
    reason: String

  }

  VALUE_OBJECT(AdminDecision) #Bisque {
    decisionDate: Date
    decisionBy: UUID
    notes: String
  }

 ENUM(Status) #Orange {
     PENDING
     APPROVED
     REJECTED
   }

   ENUM(Decision) #Orange {
        ACCEPTED
        DENIED
      }

  ContentModeration "1..*" o--> "1" AdminDecision
  Admin o--> VerificationRequest
  Admin o--> ContentModeration
  VerificationRequest "1" o--> "1" Status
  ContentModeration "1" o--> "1" Decision
}

' ===============================
' REPORTING & ANALYTICS
' ===============================
package "Reporting & Analytics Subdomain" #LightGray {
  AGGREGATE_ROOT(Report) #LightBlue {
    reportId: UUID
    generatedAt: DateTime
  }

  ENTITY(ReportData) #LightBlue {
    dataId: UUID
    content: JSON
  }

  VALUE_OBJECT(RevenueMetrics) #Bisque {
    dailyRevenue: Decimal
    weeklyRevenue: Decimal
  }

  VALUE_OBJECT(PerformanceMetrics) #Bisque {
    totalImpressions: Int
    averageCPM: Decimal
  }

  ENUM(reportType) #Orange {
    ADMIN
    ADVERTISER
    AD_SPACE_OWNER
    ADVERTISEMENT
  }

  Report "1" o--> "1" ReportData
  Report "1" o--> "1" RevenueMetrics
  Report "1" o--> "1" PerformanceMetrics
  Report "1" o--> "1" reportType
}

' ===============================
' File Handling
' ===============================
package "File Subdomain" #LightGray {
   ENTITY(File) #LightBlue {
      fileURL: string
      fileName: string
   }

   VALUE_OBJECT(fileIdentifier) #Bisque {
      fileId: UUID
   }

   File "1" o--> "1" fileIdentifier
}

' ===============================
' CROSS DOMAIN RELATIONSHIPS
' ===============================
CompanyVerification o--> UserIdentifier
AdvertiserCompany o--> UserIdentifier
AdSpaceOwner o--> UserIdentifier
Admin o--> UserIdentifier
Report o--> UserIdentifier

Advertisement o--> fileIdentifier
Report o--> fileIdentifier
MediaAsset o--> fileIdentifier
UserAccount o--> fileIdentifier

AdPlan o--> AdIdentifier
AdPlacement o--> MediaIdentifier

Advertisement o--> MediaAsset
AdIdentifier o--> Transaction
MediaIdentifier o--> Transaction

@enduml
